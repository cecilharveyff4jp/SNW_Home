# コインアニメーション実装ガイド

## 概要
コインアニメーションが実装されました。クリックすると画面上からコインがザクザク降ってきます。

## 機能
- **コイン枚数**: 1～25枚のランダム
- **大当たり**: 1%の確率で100枚
- **蓄積**: 獲得したコインはlocalStorageに保存され、合計枚数がヘッダーメニューに表示される
- **複数表示**: 隕石と同様に、アニメーション中にクリックしても描画をリセットせず、複数のコインドロップが同時に表示される

## 使い方

### 1. コイン画像の準備
`public/coin.webp` というファイル名でコイン画像を配置してください。

画像が存在しない場合は、Canvas APIで自動的に金色の円が描画されます（フォールバック）。

### 2. オブジェクトの設定
編集モードでオブジェクトを選択し、Animationフィールドに `coin` と入力します。

### 3. アニメーションの実行
参照モードでそのオブジェクトをクリックすると、コインアニメーションが開始します。

## コイン画像の推奨仕様
- **サイズ**: 128x128px 程度
- **フォーマット**: WebP（軽量で高品質）
- **背景**: 透明
- **デザイン**: 金色の円形コイン

## データの保存
- コインの合計枚数は `localStorage.getItem('totalCoins')` に保存されます
- リセットボタンでクリア可能（ヘッダーメニュー内）

## 実装の詳細

### 型定義
```typescript
type CoinDrop = {
  x: number; // スクリーン座標X（開始位置）
  y: number; // スクリーン座標Y（開始位置）
  coins: Array<{
    offsetX: number;
    offsetY: number;
    vx: number; // 横方向速度
    vy: number; // 縦方向速度（初速）
    rotation: number;
    rotationSpeed: number; // 回転速度
    size: number; // 大きさ（1=通常、1.5=大当たり）
    life: number;
    isJackpot: boolean; // 大当たりかどうか
  }>;  
  startTime: number;
  totalCoins: number; // このドロップで獲得したコイン枚数
};
```

### アニメーションの仕組み
1. クリック時に画面上部からコインが放射状に降ってくる
2. 重力加速度により下方向に加速
3. 画面下に落ちたコインは消える
4. 大当たり時はコインサイズが1.5倍、虹色のグラデーション

### 確率設定
- 通常: 99%の確率で1～25枚
- 大当たり: 1%の確率で100枚

## 今後の拡張予定
このコインは後にスロットアニメーションで使用する予定です。
